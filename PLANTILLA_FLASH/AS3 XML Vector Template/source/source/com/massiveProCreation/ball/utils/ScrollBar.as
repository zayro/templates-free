package com.massiveProCreation.ball.utils{	import flash.display.*;	import flash.events.*;	import flash.utils.Timer;
		public class ScrollBar extends MovieClip	{		// this is the y offset of the scroll bar		private var yOffset:Number;		// y minimum of the scroll bar which is always 0		private var yMin:Number;		// y maximum of the scroll bar which depends from the length of the text		private var yMax:Number;		// this is timer for the up button it's trigered every 25ms, when user clicks the up arrow of the scroll bar		private var timerUp:Timer = new Timer(25);		// this is timer for the down button it's trigered every 25ms, when user click the down arrow of the scroll bar		private var timerDown:Timer = new Timer(25);				public function ScrollBar():void		{			// add timer events			this.addEventListener(Event.ADDED_TO_STAGE, added);			timerUp.addEventListener(TimerEvent.TIMER, scrollTimerUp, false, 0, true);			timerDown.addEventListener(TimerEvent.TIMER, scrollTimerDown, false, 0, true);		}				private function added(e:Event):void {			// setup the scroll bar and the properties of the classes 			yMin = 0;			yMax = track.height - thumb.height;			thumb.addEventListener(MouseEvent.MOUSE_DOWN, thumbDown);			up.buttonMode = true;			down.buttonMode = true;			thumb.buttonMode = true;			up.addEventListener(MouseEvent.MOUSE_DOWN, scrollUp);			down.addEventListener(MouseEvent.MOUSE_DOWN, scrollDown);			// add mouse events			stage.addEventListener(MouseEvent.MOUSE_UP, thumbUp);			stage.addEventListener(Event.RESIZE, onResize);			stage.dispatchEvent(new Event(Event.RESIZE));		}						private function onResize(e:Event):void {			// on resize function sets the y maximum value 			yMax = track.height - thumb.height;			// also we set the y minimum value 			thumb.y = yMin;			// finaly we dispatch the ScrollBarEvent			dispatchEvent(new ScrollBarEvent(thumb.y / yMax));			//stage.dispatchEvent(new MouseEvent(MouseEvent.MOUSE_MOVE));		}		private function scrollUp(e:MouseEvent):void {			// this function handles the click event of the scrollUp button			thumb.y -= 2;			if(thumb.y <= yMin)				thumb.y = yMin;			if(thumb.y >= yMax)				thumb.y = yMax;			// at the end we start the timer and dispatch the ScrollBarEvent				dispatchEvent(new ScrollBarEvent(thumb.y / yMax));			timerUp.start();		}		private function scrollDown(e:MouseEvent):void {			// this fucntion handles the click event of the scrollDown button			thumb.y += 2;			if(thumb.y <= yMin)				thumb.y = yMin;			if(thumb.y >= yMax)				thumb.y = yMax;			// at the end we start the timer and dispatch the ScrollBarEvent				dispatchEvent(new ScrollBarEvent(thumb.y / yMax));			timerDown.start();		}		private function scrollTimerUp(e:TimerEvent):void {			// this function is called every 25ms when timerUp is running			thumb.y -= 2;			if(thumb.y <= yMin)				thumb.y = yMin;			if(thumb.y >= yMax)				thumb.y = yMax;			dispatchEvent(new ScrollBarEvent(thumb.y / yMax));		}		private function scrollTimerDown(e:TimerEvent):void {			// this function is called every 25ms when timerDown is running			thumb.y += 2;			if(thumb.y <= yMin)				thumb.y = yMin;			if(thumb.y >= yMax)				thumb.y = yMax;			dispatchEvent(new ScrollBarEvent(thumb.y / yMax));		}		private function thumbDown(e:MouseEvent):void		{			// this function is called then the track of the scroll bar is clicked			stage.addEventListener(MouseEvent.MOUSE_MOVE, thumbMove);			yOffset = mouseY - thumb.y;			yMax = track.height - thumb.height;			}		private function thumbUp(e:MouseEvent):void		{			// this function is called when the track of the scroll bar is up 			if(timerUp.running)				timerUp.stop();			if(timerDown.running)				timerDown.stop();								if(stage != null)				stage.removeEventListener(MouseEvent.MOUSE_MOVE, thumbMove);		}		private function thumbMove(e:MouseEvent):void		{			// this function is called when track of the scroll bar is being moved			thumb.y = mouseY - yOffset;			if(thumb.y <= yMin)				thumb.y = yMin;			if(thumb.y >= yMax)				thumb.y = yMax;			dispatchEvent(new ScrollBarEvent(thumb.y / yMax));			e.updateAfterEvent();		}	}}