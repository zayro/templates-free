package com.massiveProCreation.ball{	/*/  IMPORTS /*/	import caurina.transitions.*;		import com.massiveProCreation.ball.sections.*;	import com.massiveProCreation.events.CustomEvent;	import com.massiveProCreation.utils.loaders.XMLLoader;		import flash.display.Loader;	import flash.display.MovieClip;	import flash.display.Sprite;	import flash.display.StageDisplayState;	import flash.events.Event;	import flash.events.MouseEvent;	import flash.geom.ColorTransform;	import flash.net.URLRequest;	import flash.net.navigateToURL;	import flash.text.TextFieldAutoSize;	import flash.text.TextFormat;	public class MainAS extends Sprite {		// xml file		private var _xml:XML;		// xml loader		private var _xmlLoader:XMLLoader;		// menu		private var _menu:BallMenu;		// if subsection of menu open		private var _menuSubsection:Boolean = false;		// color transform		private var _ct:ColorTransform = new ColorTransform();		// text field format		private var _tf:TextFormat = new TextFormat();		// loader		private var _loader:Loader = new Loader();				/*/ SECTIONS /*/		// home section		private var _home:Home;		// text section		private var _text:Text;		//contact section		private var _contact:Contact;		//gallery section		private var _gallery:Gallery;		// swf section		private var _swf:Swf;		// sprite which contains logo		private var _logo:Sprite = new Sprite();		// boolean value, whether resize or not		private var dontResize:Boolean = false;		// preloader		private var pleaseWeit:PleaseWeit = new PleaseWeit();		// current section		private var _cs:Sprite;						public function MainAS(){			//load xml, setup visibility of the footer			mcFooter.visible = false;			this.addEventListener(Event.ADDED_TO_STAGE, added, false, 0, true);			}		private function added(e:Event):void {			stage.addEventListener(Event.RESIZE, onResize, false, 0, true);			_xmlLoader = new XMLLoader("main.xml");			_xmlLoader.addEventListener(CustomEvent.XML_LOADED, xmlLoaded, false, 0, true);		}		private function onResize(e:Event = null):void {			trace("resize main");			// resize effect for the footer, and webpage background			mcFooter.x = 0;			mcFooter.y = stage.stageHeight;						_logo.x = 0;			_logo.y = 0;						mcFooter.mcBlank.y = mcFooter.mcFullScreen.y = mcFooter.mcCopyrights.y = mcFooter.getChildByName("mcMenu").y =  - 28;			mcFooter.getChildByName("mcMenu").x = (stage.stageWidth - mcFooter.getChildByName("mcMenu").width) /2;			mcFooter.mcCopyrights.bg.width = mcFooter.getChildByName("mcMenu").x - 1;			mcFooter.mcFullScreen.x = stage.stageWidth;			mcFooter.mcBlank.x = mcFooter.getChildByName("mcMenu").x + mcFooter.getChildByName("mcMenu").width + 1;						if(String(_menu.activeButtonType).toLowerCase() == "gallery")				mcFooter.mcBlank.width = stage.stageWidth - mcFooter.mcBlank.x - 184;			else if (!dontResize)				mcFooter.mcBlank.width = stage.stageWidth - mcFooter.mcBlank.x - 27.5;			else				dontResize = false;								mcBg.width = stage.stageWidth;			mcBg.height = stage.stageHeight;		}		private function xmlLoaded(e:CustomEvent):void {			// xml loaded remove event listener, load webpage logo			_xml = _xmlLoader.getXML();			_xmlLoader.removeEventListener(CustomEvent.XML_LOADED, xmlLoaded);			//trace(_xml);			_xmlLoader = null;			_loader.contentLoaderInfo.addEventListener(Event.COMPLETE, logoLoaded, false, 0, true);			_loader.load(new URLRequest(String(_xml.logo.@source)));			constructFooter();		}		private function logoLoaded(e:Event):void {			// logo loaded add it to the webpage			trace("logo");			_logo.addChild(_loader.content);			this.addChild(_logo);			_logo.alpha = 0;			_logo.x = 0;			_logo.y = 0;			// show logo effect			Tweener.addTween(_logo, {alpha:1, time:1, transition:"easeOutExpo"});		}		private function constructFooter():void {			// construct footer for the webpage which contains: copyright note, menu and full screen button			_menu = new BallMenu(_xml, "bottom", int(_xml.menu[0].@fontcolor), int(_xml.menu[0].@buttoncolor));			_menu.addEventListener(CustomEvent.BUTTON_CLICK, buttonClick, false, 0, true);			_menu.addEventListener(CustomEvent.SUBBUTTON_CLICK, buttonClick, false, 0, true); 			_menu.name = "mcMenu";			mcFooter.addChild(_menu);			// SET COLOR			if(_xml.footer.@bgcolor != "")				_ct.color = uint(_xml.footer.@bgcolor);			else				_ct.color = uint(0x000000);			// setup the text of the copyritght and color of the footer (text and background)					mcFooter.mcCopyrights.bg.getChildAt(0).transform.colorTransform = _ct;			mcFooter.mcBlank.bg.getChildAt(0).transform.colorTransform = _ct;			mcFooter.mcFullScreen.bg.getChildAt(0).transform.colorTransform = _ct;						if(_xml.footer.@fontcolor != "")				_tf.color = uint(_xml.footer.@fontcolor);			else				_tf.color = uint(0xFFFFFF);								if(_xml.footer.@fontcolor != "")				_ct.color = uint(_xml.footer.@fontcolor);			else				_ct.color = uint(0xFFFFFF);			mcFooter.mcFullScreen.getChildAt(1).transform.colorTransform = _ct;			mcFooter.mcFullScreen.normal.getChildAt(0).transform.colorTransform = _ct;			mcFooter.mcFullScreen.fullScreen.getChildAt(0).transform.colorTransform = _ct;			mcFooter.mcCopyrights.copyright.htmlText = String(_xml.footer.copyrights);			mcFooter.mcCopyrights.copyright.autoSize = TextFieldAutoSize.LEFT;			mcFooter.mcCopyrights.copyright.setTextFormat(_tf);						mcFooter.mcCopyrights.mouseChildren = false;			if(String(_xml.footer.copyrights.@url) != ""){				mcFooter.mcCopyrights.buttonMode = true;				mcFooter.mcCopyrights.addEventListener(MouseEvent.CLICK, copyrightsClick, false, 0, true);			}			mcFooter.mcFullScreen.buttonMode = true;			mcFooter.mcFullScreen.mouseChildren = false;			mcFooter.mcFullScreen.addEventListener(MouseEvent.CLICK, fullScreenClick, false, 0, true);			_ct.color = uint(_xml.setup.@background);			mcBg.getChildAt(0).transform.colorTransform = _ct;			onResize();						mcFooter.y = stage.stageHeight + 50;			mcFooter.visible = true;			// show footer animation			Tweener.addTween(mcFooter, {y:stage.stageHeight, time:1, transition:"easeOutExpo"});		}		private function fullScreenClick(e:MouseEvent):void {			// full screen button click event handler			if (stage.displayState == StageDisplayState.NORMAL) {				stage.displayState=StageDisplayState.FULL_SCREEN;				Tweener.addTween(e.target.normal, {alpha:1, time:1, transition:"easeOutExpo"});				Tweener.addTween(e.target.fullScreen, {alpha:0, time:1, transition:"easeOutExpo"});							} else {				stage.displayState=StageDisplayState.NORMAL;				Tweener.addTween(e.target.normal, {alpha:0, time:1, transition:"easeOutExpo"});				Tweener.addTween(e.target.fullScreen, {alpha:1, time:1, transition:"easeOutExpo"});						}					}				private function copyrightsClick(e:MouseEvent):void {			// copyright click event, navigate to url			navigateToURL(new URLRequest(String(_xml.footer.copyrights.@url)), String(_xml.footer.copyrights.@target));		}				private function buttonClick(e:CustomEvent):void {			// button click event			var sectionType:String = _menu.activeButtonType;			var text:String;						trace(_menu.activeButtonType);			// if section type not equal to nothink and not equal to url then show the clicked section.			if(sectionType != ""){								if(sectionType != "url"){					this.addChild(pleaseWeit);					this.pleaseWeit.x = stage.stageWidth / 2;					this.pleaseWeit.y = stage.stageHeight / 2;					this.pleaseWeit.alpha = 0;					Tweener.addTween(pleaseWeit, {alpha:1, time:1, transition:"easeOutExpo"});				}								if(_xml.menu.section[_menu.buttonOff].subsection.length() > 0){										//trace("podzial kilkniety");						// choose between six types of subsections						switch (sectionType.toLowerCase()){						case "home": 										// subsection type home										_home = new Home();										_home.name = "HOME";										_home.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_home.construct(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@source), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@effect));																				if(_cs != null)											_home.alpha = 0;																					addChildAt(_home, 1);										trace("add home");										break;						case "text":											// subsection type text										_text = new Text();										_text.name = "TEXT";										_text.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_text.construct(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@name), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff]), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@background), _logo.height, 										uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@bgcolor), uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@fontcolor), Number(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@opacity));																				if(_cs != null)											_text.alpha = 0;																					addChildAt(_text, 1);										trace("add text");										break;						case "gallery":										// subsection type gallery										_gallery = new Gallery();										_gallery.name = "GALLERY";																				_gallery.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_gallery.construct(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@source),										String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@slideshow),										uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@bgcolor),										uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@fontcolor),										Number(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@opacity),										String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@thumbnails));																														if(_cs != null)											_gallery.alpha = 0;																					addChildAt(_gallery, 1);										break;						case "swf":										// subsection type swf										_swf = new Swf();										_swf.name = "SWF";										_swf.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_swf.construct(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@source));																				if(_cs != null)											_swf.alpha = 0;										addChildAt(_swf, 1);																break;						case "url":										// subsection type url										navigateToURL(new URLRequest(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@source)), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@target));										break;						case "contact":										// subsection type contact										_contact = new Contact();										_contact.name = "CONTACT";										_contact.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_contact.construct(String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@name), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff]), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@background),															String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@nick), String(_xml.menu.section[_menu.buttonOff].@email), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@message),															String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@send), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@errormessage), String(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@sendmessage), _logo.height,															uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@bgcolor), uint(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@fontcolor), Number(_xml.menu.section[_menu.buttonOff].subsection[_menu.subButtonOff].@opacity) );																				if(_cs != null)											_contact.alpha = 0;																					addChildAt(_contact, 1);																break;																}				} else {										//trace("klikniety dzial");					// choose between six diferent types of sections					switch (sectionType.toLowerCase()){						case "home": 										// section type home										_home = new Home();										_home.name = "HOME";										_home.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_home.construct(String(_xml.menu.section[_menu.buttonOff].@source), String(_xml.menu.section[_menu.buttonOff].@effect));																				if(_cs != null)											_home.alpha = 0;																					addChildAt(_home, 1);										trace("add home");										break;						case "text":											// section type text										dontResize = true;										_text = new Text();										_text.name = "TEXT";										_text.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_text.construct(String(_xml.menu.section[_menu.buttonOff].@name), String(_xml.menu.section[_menu.buttonOff]), String(_xml.menu.section[_menu.buttonOff].@background), _logo.height, 										uint(_xml.menu.section[_menu.buttonOff].@bgcolor), uint(_xml.menu.section[_menu.buttonOff].@fontcolor), Number(_xml.menu.section[_menu.buttonOff].@opacity) );																				if(_cs != null)											_text.alpha = 0;										addChildAt(_text, 1);										trace("add text");																					break;						case "gallery":										// section type gallery										_gallery = new Gallery();										_gallery.name = "GALLERY";										_gallery.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_gallery.construct(String(_xml.menu.section[_menu.buttonOff].@source));																				if(_cs != null)											_gallery.alpha = 0;																					addChildAt(_gallery, 1);																break;																	case "swf":										// section type swf										_swf = new Swf();										_swf.name = "SWF";										_swf.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_swf.construct(String(_xml.menu.section[_menu.buttonOff].@source));																				if(_cs != null)											_swf.alpha = 0;										addChildAt(_swf, 1);																				break;						case "url":										// section type url										navigateToURL(new URLRequest(String(_xml.menu.section[_menu.buttonOff].@source)), String(_xml.menu.section[_menu.buttonOff].@target));										break;						case "contact":										// section type contact										_contact = new Contact();										_contact.name = "CONTACT";										_contact.addEventListener(CustomEvent.READY_TO_DISPLAY, displaySection, false, 0, true);										_contact.construct(String(_xml.menu.section[_menu.buttonOff].@name), String(_xml.menu.section[_menu.buttonOff]), String(_xml.menu.section[_menu.buttonOff].@background),															String(_xml.menu.section[_menu.buttonOff].@nick), String(_xml.menu.section[_menu.buttonOff].@email), String(_xml.menu.section[_menu.buttonOff].@message),															String(_xml.menu.section[_menu.buttonOff].@send), String(_xml.menu.section[_menu.buttonOff].@errormessage), String(_xml.menu.section[_menu.buttonOff].@sendmessage), _logo.height,															uint(_xml.menu.section[_menu.buttonOff].@bgcolor), uint(_xml.menu.section[_menu.buttonOff].@fontcolor), Number(_xml.menu.section[_menu.buttonOff].@opacity) );																				if(_cs != null)											_contact.alpha = 0;																					addChildAt(_contact, 1);																break;																}				}			}		}				private function displaySection(e:CustomEvent):void {			// display new section and hide the old section			var lag:Number = 0.25;						if(_cs != null){							/*/ HIDE OLD SECTION /*/				// choose between four diferent types of hide effect				switch(_cs.name){										case "CONTACT":					case "TEXT":										Tweener.addTween(_cs.getChildByName("sectionContent"), {x: -450, time:1, transition:"easeOutExpo"});									Tweener.addTween(_cs.getChildByName("bg"), {x: -500, time:1, transition:"easeOutExpo"});									Tweener.addTween(_cs.getChildByName("stripes"), {x: -350, time:1, transition:"easeOutExpo"});									Tweener.addTween(_cs, {alpha:0, time:1, delay:1, transition:"easeOutExpo", onComplete:removeSection, onCompleteParams:[_cs]});									lag = 1;									break;					case "GALLERY":									Tweener.addTween(this.mcFooter.mcBlank, {width:stage.stageWidth - mcFooter.mcBlank.x - 27.5, time:1, delay:0.5, transition:"easeOutExpo"});									Tweener.addTween(_cs, {alpha:0, time:1, transition:"easeOutExpo", onComplete:removeSection, onCompleteParams:[_cs] });									Tweener.addTween(_cs.getChildByName("galleryControl"), {y:stage.stageHeight + 28, time:1, transition:"easeOutExpo"});									break;						default	   :									Tweener.addTween(_cs, {alpha:0, time:1, transition:"easeOutExpo", onComplete:removeSection, onCompleteParams:[_cs] });									break;								}			}						Tweener.addTween(pleaseWeit, {alpha:0, time:1, transition:"easeOutExpo",  onComplete:removeSection, onCompleteParams:[pleaseWeit]});						/*/ SHOW NEW SECTION /*/			// show new section choose between four diferent types of effects			switch(e.target.name){										case "CONTACT":									MovieClip(e.target.sectionContent).x = -450;									MovieClip(e.target.bg).x = -500;									MovieClip(e.target.stripes).x = -398;									Tweener.addTween(MovieClip(e.target.sectionContent), {x: 50, time:1, delay:1+lag, transition:"easeOutExpo"});									Tweener.addTween(MovieClip(e.target.bg), {x:0, time:1, delay:1+lag, transition:"easeOutExpo"});									Tweener.addTween(MovieClip(e.target.stripes), {x: 264, delay:1+lag, time:1, transition:"easeOutExpo"});									Tweener.addTween(e.target, {alpha:1, time:1, delay:0.25 + lag, transition:"easeOutExpo"});									break;										case "TEXT":										MovieClip(e.target.sectionContent).x = -450;									MovieClip(e.target.bg).x = -500;									MovieClip(e.target.stripes).x = -398;									Tweener.addTween(MovieClip(e.target.sectionContent), {x: 50, time:1, delay:1+lag, transition:"easeOutExpo"});									Tweener.addTween(MovieClip(e.target.bg), {x:0, time:1, delay:1+lag, transition:"easeOutExpo"});									Tweener.addTween(MovieClip(e.target.stripes), {x: 402, delay:1+lag, time:1, transition:"easeOutExpo"});									Tweener.addTween(e.target, {alpha:1, time:1, delay:0.25 + lag, transition:"easeOutExpo"});									break;					case "GALLERY":									e.target.galleryControl.y = stage.stageHeight+10;									Tweener.addTween(this.mcFooter.mcBlank, {width:stage.stageWidth - mcFooter.mcBlank.x - 184, time:1,  transition:"easeOutExpo"});									Tweener.addTween(e.target.galleryControl, {y:stage.stageHeight - 28, time:1, delay:0.5, transition:"easeOutExpo"});									Tweener.addTween(e.target, {alpha:1, time:1, transition:"easeOutExpo"});									break;									case "SWF" :									_swf.x = 0;									_swf.y = 0;									e.target.alpha = 1;									//addChild(_swf);									Tweener.addTween(e.target, {alpha:1, time:1, delay:0.25, transition:"easeOutExpo"});										break;										default	   :									Tweener.addTween(e.target, {alpha:1, time:1, delay:0.25, transition:"easeOutExpo"});									break;																}			// add logo and assign curent open section to _cs			addChild(_logo);				_cs = Sprite(e.target);			trace(_cs.name);		}		private function removeSection(obj:Sprite):void {			// when section is hidden and not equal to null then remove it from stage			trace(obj.name + " alpha = "+ _cs.alpha);			if(obj != null)				this.removeChild(obj);			if(obj.name == "SWF")				_swf.swfUnload();		}	}}